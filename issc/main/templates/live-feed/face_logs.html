{% extends 'base.html' %}

{% block title %} Face Logs {% endblock title %}

{% block content %}

{% load static %} 

<div class="mt-12">
  <h1 class="text-center text-4xl font-bold text-gray-800 mb-6">Face Logs</h1>

  <form method="get" class="max-w-md mx-auto mb-6">
    <label class="block text-sm font-medium text-gray-700 mb-2" for="search-input">Search by name or username</label>
    <div class="flex">
      <input
        id="search-input"
        type="text"
        name="q"
        value="{{ search_query }}"
        placeholder="e.g. Juan or admin01"
        class="flex-grow border border-gray-300 rounded-l-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"
      />
      <button type="submit" class="px-4 py-2 bg-primary text-white font-semibold rounded-r-md hover:bg-primary-dark transition">Search</button>
    </div>
  </form>

  {% if search_query %}
    <p class="text-center text-sm text-gray-600 mb-4">Filtered results for "<span class="font-semibold">{{ search_query }}</span>"</p>
  {% endif %}

  <div class="overflow-x-auto bg-white rounded-xl shadow-md p-6" style="min-width: 100%;">
    {% if logs %}
    <table class="form-table w-full text-sm text-left text-gray-700 border-collapse">
      <thead class="bg-gray-100 text-xs uppercase text-gray-600">
        <tr>
          <th class="px-4 py-3">First Name</th>
          <th class="px-4 py-3">Middle Name</th>
          <th class="px-4 py-3">Last Name</th>
          <th class="px-4 py-3">ID Number</th>
          <th class="px-4 py-3">Date</th>
          <th class="px-4 py-3">Time</th>
        </tr>
      </thead>
      <tbody>
        {% for log in logs %}
        <tr class="border-b hover:bg-gray-50">
          <td class="px-4 py-3">{{ log.first_name }}</td>
          <td class="px-4 py-3">{{ log.middle_name|default:'-' }}</td>
          <td class="px-4 py-3">{{ log.last_name }}</td>
          <td class="px-4 py-3">{{ log.id_number.id_number }}</td>
          <td class="px-4 py-3">{{ log.date }}</td>
          <td class="px-4 py-3">{{ log.time }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    {% if is_paginated %}
    <div class="flex items-center justify-between mt-6 text-sm text-gray-600">
      <div>
        Showing {{ page_obj.start_index }}&ndash;{{ page_obj.end_index }} of {{ page_obj.paginator.count }} entries
      </div>
      <div class="flex space-x-2">
        {% if page_obj.has_previous %}
          <a href="?{% if search_query %}q={{ search_query|urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}" class="px-3 py-1 border rounded hover:bg-gray-100">Previous</a>
        {% else %}
          <span class="px-3 py-1 border rounded bg-gray-100 text-gray-400 cursor-not-allowed">Previous</span>
        {% endif %}

        <span class="px-3 py-1 border rounded bg-gray-100">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
          <a href="?{% if search_query %}q={{ search_query|urlencode }}&{% endif %}page={{ page_obj.next_page_number }}" class="px-3 py-1 border rounded hover:bg-gray-100">Next</a>
        {% else %}
          <span class="px-3 py-1 border rounded bg-gray-100 text-gray-400 cursor-not-allowed">Next</span>
        {% endif %}
      </div>
    </div>
    {% endif %}
    {% else %}
    <p class="text-center text-gray-500">No face logs found.</p>
    {% endif %}
  </div>
</div>

{% endblock content %}
